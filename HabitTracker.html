<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker</title>
    <link rel="icon" type ="image/x-icon" href="">
    <link href="https://fonts.cdnfonts.com/css/smile-everyday" rel="stylesheet">
</head>
<body>
    <!--Title-->
    <h1 id="title">Month</h1>
    <h2 id="subtitle">Monthly Habit Tracker</h2>

    <!--Calender area-->
    <div id="calenderContainer">
       <div id="CalenderDiv">
          <div id="calenderHeading">
            <p id="habitTitle">My New Habit</p>
            <p id="totalDays">0/31</p>
          </div>
          <div id="calenderContent">
            <div id="tracker">
                <div class="days">
                    <div class="day">1</div>
                    <div class="day">2</div>
                    <div class="day">3</div>
                    <div class="day">4</div>
                    <div class="day">5</div>
                    <div class="day">6</div>
                    <div class="day">7</div>
                </div>
                <div class="days">
                    <div class="day">1</div>
                    <div class="day">2</div>
                    <div class="day">3</div>
                    <div class="day">4</div>
                    <div class="day">5</div>
                    <div class="day">6</div>
                    <div class="day">7</div>
                </div>
                <div class="days">
                    <div class="day">1</div>
                    <div class="day">2</div>
                    <div class="day">3</div>
                    <div class="day">4</div>
                    <div class="day">5</div>
                    <div class="day">6</div>
                    <div class="day">7</div>
                </div>
                <div class="days">
                    <div class="day">1</div>
                    <div class="day">2</div>
                    <div class="day">3</div>
                    <div class="day">4</div>
                    <div class="day">5</div>
                    <div class="day">6</div>
                    <div class="day">7</div>
                </div>
                <div class="days">
                    <div class="day">1</div>
                    <div class="day">2</div>
                    <div class="day">3</div>
                    <div class="day">4</div>
                    <div class="day">5</div>
                    <div class="day">6</div>
                    <div class="day">7</div>
                </div>
            </div>
          </div>
       </div>
    </div>
    <button id="resetButton">Reset</button>
</body>
<style>
   body {
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, rgb(239, 190, 251), rgb(200, 150, 230));
    background-size: 400% 400%;
    animation: gradientShift 8s ease infinite;
    font-family: "Smile Everyday", cursive;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

#title {
    margin-top: 60px;
    font-size: 2.5rem;
    color: rgb(140, 39, 233);
    text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
}

#subtitle {
    opacity: 0.9;
    font-size: 1.2rem;
    color: rgb(140, 39, 233);
    margin-bottom: 30px;
}

#calenderContainer {
    display: flex;
    justify-content: center;
    width: 100%;
}

#calenderDiv {
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    padding: 20px;
    max-width: 500px;
    width: 90%;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

#calenderHeading {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: rgb(140, 39, 233);
    color: white;
    padding: 10px 20px;
    font-size: 20px;
    border-radius: 10px 10px 0 0;
    font-weight: bold;
}

#calenderContent {
    padding: 20px;
    border: 2px solid rgb(140, 39, 233);
    border-top: none;
    border-radius: 0 0 15px 15px;
}

.days {
    display: flex;
    justify-content: center;
    margin-bottom: 5px;
}

.day {
    width: 40px;
    height: 40px;
    margin: 3px;
    padding: 6px;
    font-size: 16px;
    text-align: center;
    border-radius: 50%;
    background-color: white;
    color: rgb(219, 186, 251);
    border: 2px solid rgb(140, 39, 233);
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.3s ease;
}

.day:hover {
    transform: scale(1.1);
}

.day.completed {
    background-color: rgb(140, 39, 233);
    color: white;
    font-weight: bold;
}

.day.today {
    color: rgb(234, 1, 144);
    border: 3px dashed rgb(234, 1, 144);
}

#resetButton {
    margin-top: 20px;
    padding: 12px 30px;
    background-color: rgb(140, 39, 233);
    color: white;
    border: none;
    border-radius: 30px;
    font-size: 16px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
}

#resetButton:hover {
    background-color: rgb(71, 7, 130);
    transform: scale(1.05);
}

</style>

<script>
    /*Get the date*/
        var date = new Date();
        console.log(date);

        /*Extract the current date info*/
        var currMonth = date.getMonth();
        var currDay = date.getDay();
        var currDate = date.getDate();
        var currYear = date.getFullYear();

        console.log(currMonth);
        console.log(currDay);
        console.log(currDate);
        console.log(currYear);

        var months = [
            "January" ,   //0
            "February" ,   //1
            "March" ,    //2
            "April" ,   //3
            "May" ,   //4
            "June" ,   //5
            "July" ,   //6
            "August" ,   //7
            "September" ,   //8
            "October" ,   //9
            "November" ,   //10
            "December" ,   //11
        ];

        /*Set Current Month*/
        var title = document.getElementById("title");
        title.innerHTML = months[currMonth];

        /*Update the calender Info*/
        var habitTitle = document.getElementById("habitTitle");
        habitTitle.onclick = function (){
            let habits = prompt("What's your Habit?",habitTitle.innerHTML);
                if(habits.length == 0){
                    habitTitle.innerHTML = "Click to set your Habit";
                }else{
                    habitTitle.innerHTML = habits;
                }
        }
        /*Set the Total days*/
        var daysInTheMonthList = [31,28,31,30,31,30,31,31,30,31,30,31];
        if ((currYear % 4 === 0 && currYear % 100 !== 0) || currYear % 400 === 0) {
             daysInTheMonthList[1] = 29;
        }
        var daysInThisMonth = daysInTheMonthList[currMonth];

        var daysCompleted = 0;
        var totalDays = document.getElementById("totalDays");
        totalDays.innerHTML = "0/" + daysInThisMonth;

        /*Setup the calender days*/
        var dayCount = 0;
        var rowCount =0;
        var days = document.getElementsByClassName("days");
        for( var i=0; i<days.length;i++){
            var day = days[rowCount].getElementsByClassName("day");
            for( var j=0;j<day.length; j++){
                console.log(dayCount);
                if(dayCount == currDate - 1){
                    day[j].setAttribute("style","color:rgb(234,1,144);")
                    day[j].setAttribute("style","border : 2px solid black");
                }

                if(dayCount < daysInThisMonth){
                    day[j].innerHTML = dayCount + 1;
                    day[j].setAttribute("id","day"+(dayCount+1));
                    dayCount++;
                }else{
                    day[j].innerHTML ="";
                    day[j].setAttribute("style","background-color:white");
                }
            }
            rowCount++;
        }
        /*Initialize Completed Array*/
        var completed = new Array(31);
        for( var i =0; i<dayCount;i++){
            var tempString = 
            "" + (currMonth+1) + "-"+(i+1)+"-"+ currYear;
            console.log("Storing date : "+tempString);
            var tempDay = localStorage.getItem(tempString);
            console.log(tempDay);
            if(tempDay == null || tempDay == "false"){
                localStorage.setItem(tempString,"false");
            }else if(tempDay == "true"){
                daysCompleted++;
            }
            totalDays.innerHTML = daysCompleted + "/" +daysInThisMonth;
        }
        console.log("Completed array : "+completed);
        console.log("Total Days Completed : "+daysCompleted);

        /*Check Storage and Update Completed Array*/
        for( var i=0;i<currDate;i++){
            var tempString = 
            "" + (currMonth+1) + "-"+(i+1)+"-"+ currYear;
            console.log(tempString);

            var chosenDay = localStorage.getItem(tempString);
            console.log(i+1+" : "+chosenDay);
            var chosenDayDiv = document.getElementById("day"+(i+1));
            if(chosenDay === "true"){
                chosenDayDiv.style.background = "rgb(140,39,233)";
            }else if(chosenDay === "false"){
                chosenDayDiv.style.background = "white";
            }
        }

        /*Update completed on Calender*/
        var dayDivs = document.querySelectorAll(".day");
        for( var i=0;i<currDate;i++){
            dayDivs[i].onclick = function(e){
                var num = e.target.innerText;
                var selectedDate = document.getElementById(e.target.id);
                var storageString = 
                ""+(currMonth+1)+"-"+num+"-"+currYear;
                if(localStorage.getItem(storageString) === "false"){
                    selectedDate.style.backgroundColor = "rgb(140,39,233)";
                    localStorage.setItem(storageString,true);
                    daysCompleted++;
                }else if(localStorage.getItem(storageString)=== "true"){
                    selectedDate.style.backgroundColor = "white";
                    localStorage.setItem(storageString,false);
                    daysCompleted--;
                }

                totalDays.innerHTML = daysCompleted + "/" +dayCount;
                console.log(daysCompleted, currDate);
                if(daysCompleted === currDate){
                    alert("Great Progress");
                }
            }
        }

        /*Reset button*/
        var resetButton = document.getElementById("resetButton");
        resetButton.onclick = function(){
            for(var i=0;i<dayCount;i++){
                var tempString = 
            "" + (currMonth+1) + "-"+(i+1)+"-"+ currYear;
            console.log(tempString);
            localStorage.setItem(tempString,"false");
            var currDay = document.getElementById("day"+(i+1));
            currDay.style.backgroundColor = "white";
            }
            daysCompleted=0;
            totalDays.innerHTML = daysCompleted + "/"+daysInThisMonth;
        }
</script>
</html>